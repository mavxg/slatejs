<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Slate Document Editor</title>

	<link rel="stylesheet" href="styles.css" />
</head>
<body>
<div id="preview" class="content">
</div>
<script type="text/javascript" src="slate.js"></script>
<script type="text/javascript">
var preview = document.getElementById('preview');
var m = Slate.model;
var e = Slate.editor;


var table = new m.Table(1, [
	m.attrib('alignments',['left','right']),
	new m.THead(2,[
		new m.Row(5,[new m.Cell(6,["Some text to go in the cell."]), new m.Cell(15,["Header2"])])]), 
	new m.TBody(3,[
		new m.Row(7,[new m.Cell(8,[
	"Text that is not bold before",
	m.tag('strong',{}),
	"Some bold text to go in the ",
	m.tag('em',{}),"bold italic"," cell.",
	m.endtag('strong'), " and not bold after.",
	m.endtag('em')]),
			new m.Cell(17,[m.attrib('rowSpan',2),"99"])
		]),
		new m.Row(7,[new m.Cell(8,[
	"Text that is not bold before",
	m.tag('strong',{}),
	"Some bold text to go in the ",
	m.tag('em',{}),"bold italic"," cell.",
	m.endtag('strong'), " and not bold after.",
	m.endtag('em')])
		]),
		new m.Row(7,[new m.Cell(8,[m.attrib('colSpan',2),
	"Text that is not bold before",
	m.tag('strong',{}),
	"Some bold text to go in the ",
	m.tag('em',{}),"bold italic"," cell.",
	m.endtag('strong'), " and not bold after.",
	m.endtag('em')])
		])]), 
	new m.TFoot(4,[
		])]);

var doc = new m.Document(10,[
	new m.Section(12,[
		new m.H1(16, ["Dummy document"]), 
		new m.P(14,["This is some text. Lorem ipsum dolor",m.endtag('strong')," sit amet, consectetur adipisicing elit. Corrupti ",m.tag('a',{href: "http://google.co.uk"}),"vitae",m.endtag('a'),", aliquid ex necessitatibus repellat",m.tag('sup',{}),"TM",m.endtag('sup')," a illo fuga dolore aperiam totam tempore nisi neque delectus labore, nihil quae dignissimos dolores mollitia? Vel sunt neque voluptatibus excepturi laboriosam possimus adipisci quidem dolores, omnis nemo dolore",m.tag('strong',{})," eligendi blanditiis, voluptatem in doloribus hic aperiam."])]), 
	new m.Section(13,[
		table, 
		new m.P(9,["This is a test"]),
		new m.Ulli(20,["First list item"]),
		new m.Ulli(21,["Second list item"]),
		new m.Olli(22,["First list item"]),
		new m.Olli(23,["Second list item"]),
		new m.Code(24,["Some code here"]),
		new m.Code(25,["Some more code here"]),
		new m.Quote(18,["This is a",m.tag('strong',{})," really ",m.endtag('strong'),"important quote."])])
	]);


var op = new Slate.Operations().remove("Dummy").insert("Cool").end(doc.length);

function makeHugeTable(op, rows, cols) {
	var al = ['left'];
	for (var c = 0; c < cols; c++)
		op.insert('Header').insert({_type:'Cell'});
	op.insert({_type:'Row'}).insert({_type:'THead'});
	for (var r = 0; r < rows; r++) {
		for (var c = 0; c < cols; c++) {
			op.insert("Cell Content").insert({_type:'Cell'});
		}
		op.insert({_type:'Row'})
	}
	for (var c = 1; c < cols; c++)
		al.push('right');

	op.insert({_type:'TBody'});
	op.insert({attrib:'alignments', value:al});
	op.insert({_type:'Table'});
}

var opB = new Slate.Operations().retain(doc.children[0].length-1).insert("Some Text").insert({_type:'P'});

makeHugeTable(opB, 100, 5);

//doc = m.apply(doc, op)

opB.end(doc.length);

//opB = opB.transform(op);

var opC = new Slate.Operations().retain(480).remove('Cell').insert("Bell");



var NonServerAdaptor = Slate.server.NonServerAdaptor;

var serverAdaptor = new NonServerAdaptor();

var store = new Slate.Store(serverAdaptor);
store.document = doc;

function insertHugeTable(s, c) {
	var doc = store.document;
	var op = new Slate.Operations().retain(doc.children[0].length-1);
	makeHugeTable(op, s, c);
	op.end(doc.length);
	store.apply(op);
}

store.apply(opB);
opC.end(store.document.length);
store.apply(opC);

var editor = e.Editor({store: store});


//var tf = new e.Document({obj: doc});
e.friar.renderComponent(editor, preview);
</script>
</body>
</html>